--[[██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
   ░▒▓█████▓▒░     ░▒▓█▓▒░        ░▒▓█▓▒░░▒▓█▓▒░  ░▒▓███████▓▒░   ░▒▓██████▓▒░   ░▒▓█▓▒░ ░▒▓█▓▒░  ░▒▓███████▓▒░    ░▒▓███████▓▒░
  ░▒▓█▓▒░░▒▓█▓▒░   ░▒▓█▓▒░        ░▒▓█▓▒░░▒▓█▓▒░     ░▒▓█▓▒░     ░▒▓█▓▒░░▒▓█▓▒░  ░▒▓█▓▒░ ░▒▓█▓▒░  ▒▓░    ░▒▓█▓▒░   ░▒▓█▒░  ░▒▓█▒░
  ░▒▓█▓▒░          ░▒▓█▓▒░        ░▒▓█▓▒░░▒▓█▓▒░     ░▒▓█▓▒░     ░▒▓█▓▒░         ░▒▓█▓▒░ ░▒▓█▓▒░         ░▒▓█▓▒░   ░▒▓█▒░  ░▒▓█▒░
  ░▒▓█▓▒▒▓███▓▒░   ░▒▓█▓▒░         ░▒▓██████▓▒░      ░▒▓█▓▒░     ░▒▓█▓▒░         ░▒▓█████████▓▒░     ░▒▓███▓▒░     ░▒▓███████▓▒░
  ░▒▓█▓▒░░▒▓█▓▒░   ░▒▓█▓▒░           ░▒▓█▓▒░         ░▒▓█▓▒░     ░▒▓█▓▒░         ░▒▓█▓▒░ ░▒▓█▓▒░         ░▒▓█▓▒░   ░▒▓█▓▒░  ░▒▓▒░
  ░▒▓█▓▒░░▒▓█▓▒░   ░▒▓█▓▒░           ░▒▓█▓▒░         ░▒▓█▓▒░     ░▒▓█▓▒░░▒▓█▓▒░  ░▒▓█▓▒░ ░▒▓█▓▒░  ▒▓░    ░▒▓█▓▒░   ░▒▓█▓▒░  ░▒█▒░
   ░▒▓██████▓▒░    ░▒▓████████▓▒░    ░▒▓█▓▒░         ░▒▓█▓▒░      ░▒▓██████▓▒░   ░▒▓█▓▒░ ░▒▓█▓▒░  ░▒▓███████▓▒░    ░▒▓█▓▒░  ░▒█▒░
|‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾|
|                        				 Custom  PZ  Mod  Developer  for  Hire													  |
|‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾|
|                       	Portfolio:  https://steamcommunity.com/id/glytch3r/myworkshopfiles/							          |
|                       		                                    														 	  |
|                       	Discord:    Glytch3r#1337 / glytch3r															      |
|                       		                                    														 	  |
|                       	Support:    https://ko-fi.com/glytch3r														    	  |
|_______________________________________________________________________________________________________________________________-]]
--[[_____________________________________________________________________________________________________________________________
   ░▒▓██████▓▒░    ░▒▓████████▓▒░    ░▒▓█▓▒░         ░▒▓█▓▒░      ░▒▓██████▓▒░   ░▒▓█▓▒░ ░▒▓█▓▒░  ░▒▓███████▓▒░    ░▒▓█▓▒░  ░▒█▒░
  ░▒▓█▓▒░░▒▓█▓▒░   ░▒▓█▓▒░           ░▒▓█▓▒░         ░▒▓█▓▒░     ░▒▓█▓▒░░▒▓█▓▒░  ░▒▓█▓▒░ ░▒▓█▓▒░  ▒▓░    ░▒▓█▓▒░   ░▒▓█▓▒░  ░▒█▒░
  ░▒▓█▓▒░░▒▓█▓▒░   ░▒▓█▓▒░           ░▒▓█▓▒░         ░▒▓█▓▒░     ░▒▓█▓▒░         ░▒▓█▓▒░ ░▒▓█▓▒░         ░▒▓█▓▒░   ░▒▓█▓▒░  ░▒▓▒░
  ░▒▓█▓▒▒▓███▓▒░   ░▒▓█▓▒░         ░▒▓██████▓▒░      ░▒▓█▓▒░     ░▒▓█▓▒░         ░▒▓█████████▓▒░     ░▒▓███▓▒░     ░▒▓███████▓▒░
  ░▒▓█▓▒░          ░▒▓█▓▒░        ░▒▓█▓▒░░▒▓█▓▒░     ░▒▓█▓▒░     ░▒▓█▓▒░         ░▒▓█▓▒░ ░▒▓█▓▒░         ░▒▓█▓▒░   ░▒▓█▒░  ░▒▓█▒░
  ░▒▓█▓▒░░▒▓█▓▒░   ░▒▓█▓▒░        ░▒▓█▓▒░░▒▓█▓▒░     ░▒▓█▓▒░     ░▒▓█▓▒░░▒▓█▓▒░  ░▒▓█▓▒░ ░▒▓█▓▒░  ▒▓░    ░▒▓█▓▒░   ░▒▓█▒░  ░▒▓█▒░
   ░▒▓█████▓▒░     ░▒▓█▓▒░        ░▒▓█▓▒░░▒▓█▓▒░  ░▒▓███████▓▒░   ░▒▓██████▓▒░   ░▒▓█▓▒░ ░▒▓█▓▒░  ░▒▓███████▓▒░    ░▒▓███████▓▒░
█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████--]]



StuffGrabber = StuffGrabber or {}


-----------------------            ---------------------------
--[[
if instanceof(item, "IsoWorldInventoryObject") then

end
 ]]
--[[
local stuff =
for i,_ in pairs(stuff) do
    local item = i
     item = pl:getInventory():AddItem(body:getItem())
    body:getSquare():removeCorpse(body, false)
    local dropX,dropY,dropZ = ISInventoryTransferAction.GetDropItemOffset(pl, pSq, bodyItem)
    pl:getCurrentSquare():AddWorldInventoryItem(bodyItem, dropX, dropY, dropZ)
    pl:getInventory():Remove(bodyItem)
end
ISInventoryPage.renderDirty = true


]]

function StuffGrabber.getStuffList()
    return SandboxVars.StuffGrabber.StuffList or  "Base.Katana;Base.Apple;Base.Log"
end



function StuffGrabber.parseList()
    local items = {}
    local strList = StuffGrabber.getStuffList()
    for item in string.gmatch(strList, "[^;]+") do
        table.insert(items, item)
    end
    return items
end

function StuffGrabber.context(player, context, worldobjects, test)
	local pl = getSpecificPlayer(player)
	local sq = clickedSquare
	local targ = clickedPlayer
	if sq then
		local Main = context:addOptionOnTop("StuffGrabber: ")
		Main.iconTexture = getTexture("media/ui/chop_tree.png")
		local opt = ISContextMenu:getNew(context)
		context:addSubMenu(Main, opt)
		local optTip = opt:addOption('stuff', worldobjects, function()
			context:hideAndChildren()
		end)
		local tip = ISWorldObjectContextMenu.addToolTip()
		tip.description = ""
		optTip.toolTip:setName(Main:getName())
		optTip.toolTip = tip
		optTip.notAvailable = true
	end
end
Events.OnFillWorldObjectContextMenu.Remove(StuffGrabber.context)
Events.OnFillWorldObjectContextMenu.Add(StuffGrabber.context)

-----------------------            ---------------------------
local rad = 14
local pl = getPlayer()
local stuff = {}
local cell = pl:getCell()
local x, y, z = pl:getX(), pl:getY(), pl:getZ()
for xDelta = -rad, rad do
	for yDelta = -rad, rad do
		local targSq = cell:getOrCreateGridSquare(x + xDelta, y + yDelta, z)
		for i=0, targSq:getObjects():size()-1 do
			local item = targSq:getObjects():get(i)
            if instanceof(item, "IsoWorldInventoryObject") then
                local name = item:getName()
                if name then
                    if name == 'Log' then
                        ISTimedActionQueue.add(ISWalkToTimedAction:new(pl, targSq))
                        local time = ISWorldObjectContextMenu.grabItemTime(pl, item)
                        ISTimedActionQueue.add(ISGrabItemAction:new(pl, item, time))
                        print(item:getName())
                    end
                end
            end
		end
	end
end
-----------------------            ---------------------------
local pl = getPlayer()
local targSq = pl:getSquare()
for i=0, targSq:getObjects():size()-1 do
    local item = targSq:getObjects():get(i)
    if instanceof(item, "IsoWorldInventoryObject") then
        local name = item:getName()
        if name then
            if name == 'Log' then
                ISTimedActionQueue.add(ISWalkToTimedAction:new(pl, targSq))
                local time = ISWorldObjectContextMenu.grabItemTime(pl, item)
                ISTimedActionQueue.add(ISGrabItemAction:new(pl, item, time))
                print(item:getName())
            end
        end
    end
end


-----------------------            ---------------------------
	if targSq and luautils.walkAdj(pl, targSq) then

		local count = 0
		--for _,WItem in ipairs(WItems) do
			ISTimedActionQueue.add(ISGrabItemAction:new(pl, item, time))
			--count = count + 1
			--if count >= #WItems / 2 then return end
		--end
    end
-----------------------            ---------------------------
for i = 1, #stuff do
    local item = stuff[i]
    print(item)
end



local randSq = getPlayer():getSquare():getRoom():getRandomSquare()



local targSq =
if targSq ~= sq then
    ISTimedActionQueue.add(ISWalkToTimedAction:new(pl, targSq))
end

print(randSq)



local pl = getPlayer()
local inv = pl:getInventory()
local item = inv:FindAndReturn('Base.Katana')
local sq = getPlayer():getSquare()
if item then
    ISTimedActionQueue.add(ISDropItemAction:new(pl, item, 23))
   -- ISTimedActionQueue.add(ISDropWorldItemAction:new(pl, item, sq, ZombRand(0,3), ZombRand(0,3), 0, ZombRand(0,5), false))
end


-----------------------            ---------------------------
print(getPlayer():getPrimaryHandItem():getFullType())

local inv = getPlayer():getInventory():

pl:getInventory():AddItem(body:getItem())



ISWorldObjectContextMenu.onGrabWItem = function(worldobjects, WItem, player)
	local playerObj = getSpecificPlayer(player)
    if WItem:getSquare() and luautils.walkAdj(playerObj, WItem:getSquare()) then
		local time = ISWorldObjectContextMenu.grabItemTime(playerObj, WItem)
		ISTimedActionQueue.add(ISGrabItemAction:new(playerObj, WItem, time))
	end
end

ISWorldObjectContextMenu.onGrabHalfWItems = function(worldobjects, WItems, player)
	WItem = WItems[1]
	local playerObj = getSpecificPlayer(player)
	if WItem:getSquare() and luautils.walkAdj(playerObj, WItem:getSquare()) then
		local time = ISWorldObjectContextMenu.grabItemTime(playerObj, WItem)
		local count = 0
		for _,WItem in ipairs(WItems) do
			ISTimedActionQueue.add(ISGrabItemAction:new(playerObj, WItem, time))
			count = count + 1
			if count >= #WItems / 2 then return end
		end
    end
end

ISWorldObjectContextMenu.onGrabAllWItems = function(worldobjects, WItems, player)
	WItem = WItems[1]
	local playerObj = getSpecificPlayer(player)
	if WItem:getSquare() and luautils.walkAdj(playerObj, WItem:getSquare()) then
		local time = ISWorldObjectContextMenu.grabItemTime(playerObj, WItem)
		for _,WItem in ipairs(WItems) do
			ISTimedActionQueue.add(ISGrabItemAction:new(playerObj, WItem, time))
		end
	end
end